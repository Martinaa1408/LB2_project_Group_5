# LAB2_project - von Heijne Method 

This repository contains an implementation of the **Von Heijne statistical method (1986)** for signal peptide cleavage site prediction.  
It provides an interpretable, frequency-based baseline to compare against machine learning classifiers.

---

## **Method Overview**

The method builds a **Position-Specific Weight Matrix (PSWM)** from experimentally validated signal peptide sequences and compares them to background amino acid frequencies (SwissProt).  
Pseudocounts (+1) are added to avoid zero probabilities.  

- **Window size**: 16 amino acids (–13 upstream, +2 downstream of cleavage site)  
- **Background distribution**: SwissProt amino acid frequencies  
- **PSWM**: constructed from positive examples  
- **Scoring**: candidate windows are scored with the PSWM; the maximum score in the N-terminal region is used as prediction  

The log-odds formula for PSWM is:

```math
W_{k,j} = \log \left( \frac{M_{k,j}}{b_k} \right) \\
M_{k,j}: \text{ probability of amino acid } k \text{ at position } j \\
b_k: \text{ background frequency of amino acid } k \\
W_{k,j}: \text{ log-odds weight}
```

---

## **Implementation**

All steps are contained in a single notebook: [`vonHeijne.ipynb`](vonHeijne.ipynb)

Pipeline:  
1. **Window extraction** from annotated cleavage sites  
2. **Count → PSPM → PSWM** (with pseudocount normalization)  
3. **Sliding window scoring** (scan N-terminal region, keep max score)  
4. **Threshold optimization** on validation set (F1 maximization)  
5. **Testing and cross-validation** with evaluation metrics  

---
## **Evaluation**

Binary classification task:  
- Class 1 = protein with signal peptide  
- Class 0 = protein without signal peptide  

Metrics reported:  
- Accuracy (ACC)  
- Precision (PPV)  
- Recall / Sensitivity (SEN)  
- F1-score  
- Matthews Correlation Coefficient (MCC)  

Results are averaged over **5-fold cross-validation**, reported as **mean ± standard error**.  

### Final Metrics

| **Metric**   | **Value**            |
|--------------|----------------------|
| Accuracy     | 0.939 ± 0.002        |
| Precision    | 0.708 ± 0.017        |
| Sensitivity  | 0.756 ± 0.032        |
| F1 Score     | 0.728 ± 0.011        |
| MCC          | 0.697 ± 0.013        |
| Threshold    | 9.123                |

---

## **Visualization**

All plots are generated by the notebook and saved in: Plots/

| **Plot** | **Description** |
|----------|-----------------|
| `pr_curve_foldX.png` | Precision–Recall curve with optimal threshold (per fold) |
| `cm_foldX.png` | Confusion matrix for corresponding fold |
| `pr_curve_all.png` | Combined Precision–Recall curves (all folds, with thresholds) |
| `pswm_heatmap.png` | Heatmap visualization of the Position-Specific Weight Matrix |


